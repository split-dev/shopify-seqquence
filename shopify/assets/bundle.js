!function(){var e={757:function(e,t,r){e.exports=r(666)},666:function(e){var t=function(e){"use strict";var t,r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),i=new q(n||[]);return a._invoke=function(e,t,r){var n=d;return function(o,a){if(n===p)throw new Error("Generator is already running");if(n===h){if("throw"===o)throw a;return O()}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var c=E(i,r);if(c){if(c===m)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===d)throw n=h,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=p;var s=l(e,t,r);if("normal"===s.type){if(n=r.done?h:f,s.arg===m)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n=h,r.method="throw",r.arg=s.arg)}}}(e,r,i),a}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d="suspendedStart",f="suspendedYield",p="executing",h="completed",m={};function g(){}function y(){}function v(){}var w={};s(w,a,(function(){return this}));var b=Object.getPrototypeOf,S=b&&b(b(_([])));S&&S!==r&&n.call(S,a)&&(w=S);var x=v.prototype=g.prototype=Object.create(w);function k(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function L(e,t){function r(o,a,i,c){var s=l(e[o],e,a);if("throw"!==s.type){var u=s.arg,d=u.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,i,c)}),(function(e){r("throw",e,i,c)})):t.resolve(d).then((function(e){u.value=e,i(u)}),(function(e){return r("throw",e,i,c)}))}c(s.arg)}var o;this._invoke=function(e,n){function a(){return new t((function(t,o){r(e,n,t,o)}))}return o=o?o.then(a,a):a()}}function E(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,E(e,r),"throw"===r.method))return m;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var o=l(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var a=o.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function q(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function _(e){if(e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}return{next:O}}function O(){return{value:t,done:!0}}return y.prototype=v,s(x,"constructor",v),s(v,"constructor",y),y.displayName=s(v,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,c,"GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},k(L.prototype),s(L.prototype,i,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new L(u(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},k(x),s(x,c,"Generator"),s(x,a,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=_,q.prototype={constructor:q,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),A(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},861:function(e,t,r){"use strict";function n(e,t,r,n,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void r(e)}c.done?t(s):Promise.resolve(s).then(n,o)}function o(e){return function(){var t=this,r=arguments;return new Promise((function(o,a){var i=e.apply(t,r);function c(e){n(i,o,a,c,s,"next",e)}function s(e){n(i,o,a,c,s,"throw",e)}c(void 0)}))}}r.d(t,{Z:function(){return o}})}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,r),a.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";document.addEventListener("DOMContentLoaded",(function(){window.console.log("Hello from main.js ðŸ‘‹.");var e=document.querySelector("#menu-drawer"),t=document.querySelector("#Details-menu-drawer-container");window.onclick=function(r){r.target!=e&&t.classList.remove("menu-opening")}}))}(),function(){"use strict";var e=r(861),t=r(757),n=r.n(t);!function(){var t,r="ai-search",o=document.getElementById("aiSearch"),a=document.querySelector(".js-get-new-prompt"),i=document.querySelectorAll(".js-search-view"),c=localStorage.getItem(r),s="https://lime-filthy-duckling.cyclic.app",u=c?JSON.parse(c):{},l=function(e){return new Promise((function(t){return setTimeout(t,e)}))},d={},f={},p=new Map,h="https://cdn.shopify.com/videos/c/vp/21de78cbe14f46cbbc3e8f54adfd86b4/21de78cbe14f46cbbc3e8f54adfd86b4.SD-480p-1.5Mbps-12651580.mp4",m=new URL(document.location).searchParams.get("search")||"",g="on"===new URL(document.location).searchParams.get("preventAutoExtend"),y=document.querySelectorAll(".js-search-view .search__wrapper");if(o&&i.length){var v=function(e){window.gtag&&window.gtag("event","error",{event_category:"Replicate AI ERROR",event_label:"Images request error",value:e})},w=function(){var e=document.querySelector(".js-search-dom-template"),t=e.content.cloneNode(!0),r=a.closest(".js-search-view");e.before(t);var n=r.querySelector(".js-search-swiper:not(.swiper-initialized)");return window.Swiper&&new Swiper(n,{slidesPerView:3.5,spaceBetween:30,freeMode:!0,mousewheel:!0,breakpoints:{767:{slidesPerView:3.5},320:{slidesPerView:1.2}},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}}),n},b=function(e){y=document.querySelectorAll(".js-search-view .search__wrapper"),e.forEach((function(e,t){e.error?v(e.error):p.get(e.prompt)?p.set(e.prompt,Object.assign({},p.get(e.prompt),e.images)):p.set(e.prompt,e.images)}));var t=p.keys();Array.from(t).forEach((function(e,t){var r=p.get(e);d[t]=d[t]||{},f[t]=f[t]||{},Object.keys(r).forEach((function(n){r[n]&&r[n].generatedImg&&(f[t][n]=r[n].generatedImg),r[n]&&r[n].tShirtResult?d[t][n]=r[n].tShirtResult:v("There is no image result for search query: ".concat(e," and id: ").concat(n))})),y[t]||(w(),y=document.querySelectorAll(".js-search-view .search__wrapper"));var n=y[t].querySelector(".js-search-swiper"),o=y[t].querySelector(".js-search-prompt"),a=y[t].querySelector(".js-generate-more"),i=n.getAttribute("data-mockup-src"),c=n.getAttribute("data-mockup-url");o&&(o.textContent=e),a&&a.setAttribute("data-prompt",e),n&&(Object.keys(f[t]).forEach((function(e,r){console.log("url(".concat(f[t][e],")"));var o=n.querySelectorAll(".swiper-slide")[r];o?o.querySelector(".preview-image").style.backgroundImage="url(".concat(f[t][e],")"):n.swiper.appendSlide('<div class="swiper-slide">\n                            <div class="preview-image" style="background-image: url('.concat(f[t][e],')"></div>\n                            <img src="').concat(i,'" onerror="this.src=').concat(i,'" />\n                            <button data-mockup="').concat(c,'" data-id="').concat(e,'" class="btn btn--secondary js-get-product-redirect button button--secondary"><span>Buy</span></button>\n                            <video loop muted autoplay playsinline width="210"><source src="').concat(h,'" type="video/mp4"/></video>\n                        </div>'))})),Object.keys(d[t]).forEach((function(e,r){var o=n.querySelectorAll(".swiper-slide")[r];o?(o.querySelector(".preview-image").style.opacity="0",o.querySelector("IMG").setAttribute("src",d[t][e]),o.querySelector(".js-get-product-redirect").setAttribute("data-id","".concat(e)),o.classList.add("customized")):n.swiper.appendSlide('<div class="swiper-slide customized">\n                            <div class="preview-image"></div>\n                            <img src="'.concat(d[t][e],'" onerror="this.src=').concat(i,'" />\n                            <button data-mockup="').concat(c,'" data-id="').concat(e,'" class="btn btn--secondary js-get-product-redirect button button--secondary"><span>Buy</span></button>\n                            <video loop muted autoplay playsinline width="210"><source src="').concat(h,'" type="video/mp4"/></video>\n                        </div>'))})),n.swiper.slides[n.swiper.slides.length-1].classList.contains("customized")&&n.swiper.appendSlide('<div class="swiper-slide">\n                        <div class="preview-image"></div>\n                        <img src="'.concat(i,'" />\n                        <button data-mockup="').concat(c,'" class="btn btn--secondary js-get-product-redirect button button--secondary"><span>Buy</span></button>\n                        <video loop muted autoplay playsinline width="210"><source src="').concat(h,'" type="video/mp4"/></video>\n                    </div>')))})),console.log("FULL imagesResult :>> ",d)},S=function(){var t=(0,e.Z)(n().mark((function e(t,r){var o,a,i,c,u;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.time("waitImagesResult"),a=r||2500,i=0,c=0;case 4:if(!(c<100)){e.next=28;break}return e.next=7,fetch("".concat(s,"/image?requestId=").concat(t.join(",")),{method:"GET"});case 7:return u=e.sent,e.next=10,u.json();case 10:if(o=e.sent,200===u.status){e.next=15;break}return console.error(o),v("Error images request ".concat(JSON.stringify(o))),e.abrupt("return",o);case 15:if(console.log("imagesResponse",o),n=t.length,(d=o).length!==n||!d.every((function(e){return e.images&&Object.keys(e.images).length&&Object.keys(e.images).every((function(t){return e.images[t].printifyId}))}))){e.next=20;break}return console.timeEnd("waitImagesResult"),A(),e.abrupt("break",28);case 20:return o.length>i&&(b(o),i=o.length),console.log("pending images...next ping in ".concat((a/1e3).toFixed(1)," seconds")),e.next=24,l(a);case 24:c?a*=1.03:a=400;case 25:c+=1,e.next=4;break;case 28:return 0===o.length&&v("Can't get images. Probably DB connection error"),b(o),e.abrupt("return",o);case 31:case"end":return e.stop()}var n,d}),e)})));return function(e,r){return t.apply(this,arguments)}}(),x=function(){var t=(0,e.Z)(n().mark((function e(t,o){var a,i,c;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.time("generateImages with Replicate AI"),e.next=3,fetch("".concat(s,"/prompt"),{method:"POST",headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json"},body:JSON.stringify((n={preventAutoExtend:g},l=o?"fullPrompt":"prompt",d=t,l in n?Object.defineProperty(n,l,{value:d,enumerable:!0,configurable:!0,writable:!0}):n[l]=d,n))});case 3:return a=e.sent,e.next=6,a.json();case 6:if(i=e.sent,201===a.status){e.next=10;break}return console.error(i),e.abrupt("return",!1);case 10:return c=i.map((function(e){return e.id})),i.map((function(e){return e.input.prompt})).forEach((function(e,t){u[m]=u[m]||{},u[m]&&(u[m][e]?u[m][e].push(c[t]):u[m][e]=[c[t]])})),localStorage.setItem(r,JSON.stringify(u)),console.timeEnd("generateImages with Replicate AI"),e.next=17,S(c);case 17:return e.abrupt("return",e.sent);case 18:case"end":return e.stop()}var n,l,d}),e)})));return function(e,r){return t.apply(this,arguments)}}(),k=function(){var t=(0,e.Z)(n().mark((function e(t,r,o,a,i){var c,u,l,d;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.time("getPrintifyProduct"),window.sessionStorage.setItem("currentCreatingProduct",null),c=window.open("".concat(i,"?key=").concat(r),"_blank"),e.next=5,fetch("".concat(s,"/printify-product"),{method:"POST",headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json"},body:JSON.stringify({imageId:r,type:"t-shirt",prompt:o})});case 5:return u=e.sent,e.next=8,u.json();case 8:if(l=e.sent,E(t,!1),console.timeEnd("getPrintifyProduct"),l.id){e.next=14;break}return console.error(l),e.abrupt("return",!1);case 14:console.log("response",l),d="/products/".concat(l.title.toLowerCase().replace(/[^a-z|0-9]+/gim,"-")),window.sessionStorage.setItem("currentCreatingProduct",d),c.sessionStorage.setItem("currentCreatingProduct",d),c.location.reload();case 19:case"end":return e.stop()}}),e)})));return function(e,r,n,o,a){return t.apply(this,arguments)}}(),L=function(e,t){var r=e.querySelector("SPAN");t?(e.classList.add("loading"),r&&(r.textContent="Loading...")):(e.classList.remove("loading"),r&&(r.textContent="Create More of this Style"))},E=function(e,t){var r=e.querySelector("SPAN");t?(e.classList.add("loading"),r&&(r.textContent="Wait...")):(e.classList.remove("loading"),r&&(r.textContent="Buy"))},j=function(e){e?e.classList.add("loading"):document.querySelectorAll(".js-search-view .search__wrapper").forEach((function(e){e.classList.add("loading")}))},A=function(e){e?e.classList.remove("loading"):document.querySelectorAll(".js-search-view .search__wrapper").forEach((function(e){e.classList.remove("loading")}))};try{Pusher.logToConsole=!0,new Pusher("de22d0c16c3acf27abc0",{cluster:"eu"}).subscribe("my-channel").bind("my-event",(function(e){console.log(e)}))}catch(e){console.error("pusher error",e)}if(m.length){if(u[m]&&!g){var q=Object.values(u[m]).reduce((function(e,t){return e.concat(t)}),[]);S(q,1).then((function(e){A(),console.log("Got images from LS :>> ",e)}))}else x(m,!1,1).then((function(e){return e})).then((function(e){A(),console.log("Got images from Replicate API :>> ",e)}));document.querySelector(".search").addEventListener("click",(function(e){var t;if(e.target.classList.contains("js-get-product-redirect")?t=e.target:"img"===e.target.tagName.toLowerCase()&&(t=e.target.closest(".swiper-slide").querySelector(".js-get-product-redirect")),!t||t.classList.contains("loading"))return!1;E(t,!0),k(t,t.getAttribute("data-id"),m,Array.from(t.closest(".swiper-slide").parentNode.children).indexOf(t.closest(".swiper-slide"))*document.querySelectorAll(".js-search-swiper").length,t.getAttribute("data-mockup"))})),i.forEach((function(e,t){e.addEventListener("click",(function(e){if(e.target.classList.contains("js-generate-more")||e.target.closest(".js-generate-more")){var t=e.target.closest(".js-generate-more")?e.target.closest(".js-generate-more"):e.target,r=t.closest(".search__wrapper");if(t.classList.contains("loading"))return!1;j(r),L(t,!0),x(t.getAttribute("data-prompt"),!0).then((function(e){return e})).then((function(e){A(r),L(t,!1),console.log("Got images from Replicate API :>> ",e)}))}}))})),a&&a.addEventListener("click",(0,e.Z)(n().mark((function e(){var r,o,i,c,u;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.classList.contains("loading")){e.next=2;break}return e.abrupt("return",!1);case 2:if(L(a,!0),t){e.next=13;break}return e.next=6,fetch("".concat(s,"/available-prompts?prompt=").concat(m),{method:"GET",headers:{"Access-Control-Allow-Origin":"*","Content-Type":"application/json"}});case 6:return r=e.sent,e.next=9,r.json();case 9:if(t=e.sent,200===r.status){e.next=13;break}return console.error(t),e.abrupt("return",!1);case 13:i=0;case 14:if(!(i<t.length)){e.next=21;break}if(p.get(t[i])){e.next=18;break}return o=t[i],e.abrupt("break",21);case 18:i+=1,e.next=14;break;case 21:o||(c=Math.floor(Math.random()*t.length),o=t[c]),u=w(),j(u.closest(".search__wrapper")),x(o,!0).then((function(e){return e})).then((function(e){L(a,!1),A(),console.log("Got images from Replicate API :>> ",e)}));case 25:case"end":return e.stop()}}),e)}))))}o.querySelector('input[name="search"]').value=m,o.querySelector('input[name="preventAutoExtend"]').checked=g}}()}(),function(){"use strict";var e=r(861),t=r(757),n=r.n(t);function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){s=!0,i=e},f:function(){try{c||null==r.return||r.return()}finally{if(s)throw i}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}!function(){var t,r=window.location.pathname.includes("/product")&&document.body.classList.contains("template-product"),a=window.location.pathname.includes("/cart"),i="https://lime-filthy-duckling.cyclic.app",c=new URL(document.location).searchParams.get("key")||"",s=window.sessionStorage.getItem("currentCreatingProduct"),u=new Map,l=document.querySelector("#cart-notification"),d=document.querySelector("#main-cart-items"),f=(document.querySelectorAll('.product-card-wrapper img[src*="mockup"]'),function(e){return new Promise((function(t){return setTimeout(t,e)}))}),p=["tShirtResult","tShirtBlackResult","imageStandard","imageFull"],h=function(e){window.gtag&&window.gtag("event","error",{event_category:"Replicate AI ERROR",event_label:"Images request error",value:e})},m=function(e){var r,n;e=e||t;var o=document.querySelectorAll(".product-media-modal__content img, .product__media img"),a=document.querySelectorAll(".product-form Form"),i="Black"===document.querySelector('.product [name="Color"]:checked').value,s=null===(r=e.images[c])||void 0===r?void 0:r.tShirtResult,l=null===(n=e.images[c])||void 0===n?void 0:n.tShirtBlackResult;s&&(o.forEach((function(e){e.removeAttribute("srcset"),e.setAttribute("src",i&&l||s)})),a.forEach((function(t){Object.keys(e.images[c]).forEach((function(r){var n=document.createElement("input");u.set(r,e.images[c][r]),n.setAttribute("type","hidden"),n.setAttribute("name","properties[".concat(r,"]")),n.setAttribute("value",e.images[c][r]),t.prepend(n)}))})))},g=function(){document.querySelectorAll(".cart-item").forEach((function(e){var t=e.querySelectorAll(".product-option"),r=e.querySelector(".cart-item__image"),n={},o=!1;t.forEach((function(e){if(e.querySelector("dd")){var t=e.querySelector("dt").textContent.trim(),r=e.querySelector("dd").textContent.trim(),a=t.replace(":","");"Color"===a&&(o="Black"===r),p.indexOf(a)>-1&&(e.classList.add("hidden"),n[a]=r)}})),n.tShirtResult&&r.setAttribute("src",o&&n.tShirtBlackResult||n.tShirtResult)}))},y=function(){var r=(0,e.Z)(n().mark((function e(r){var o,a,c,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=1e3,r){e.next=3;break}return e.abrupt("return");case 3:c=0;case 4:if(!(c<270)){e.next=27;break}return e.next=7,fetch("".concat(i,"/image?imageId=").concat(r),{method:"GET"});case 7:return s=e.sent,e.next=10,s.json();case 10:if(o=e.sent,200===s.status){e.next=15;break}return console.error(o),h("Error images request ".concat(JSON.stringify(o))),e.abrupt("return",o);case 15:if(!o.length){e.next=19;break}if(!(t=o[0]).images||!t.images[r].imageFull){e.next=19;break}return e.abrupt("break",27);case 19:return t.images[r].tShirtResult&&m(t),console.log("pending images...next ping in ".concat(a/1e3," seconds")),e.next=23,f(a);case 23:a=1e3;case 24:c+=1,e.next=4;break;case 27:return 0===o.length&&h("Can't get images. Probably DB connection error"),m(t),e.abrupt("return",t);case 30:case"end":return e.stop()}}),e)})));return function(e){return r.apply(this,arguments)}}();if(r&&c)if(y(c),s){var v=document.querySelector(".product__info-wrapper");console.time("Creating real product");v.classList.add("loading");var w=function(){var t=(0,e.Z)(n().mark((function e(){var t,r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(s,".js"),{method:"GET"});case 2:if(200!==(t=e.sent).status){e.next=10;break}return e.next=6,t.json();case 6:(r=e.sent).available&&r.images.length?(console.timeEnd("Creating real product"),console.log("FINALLY got product!!! ",r),window.sessionStorage.removeItem("currentCreatingProduct"),v.classList.remove("loading"),document.location.href=r.url):setTimeout(w,1e3),e.next=11;break;case 10:setTimeout(w,1e3);case 11:case"end":return e.stop()}}),e)})));return function(){return t.apply(this,arguments)}}();w()}else{if(l){new MutationObserver((function(e,t){var r,n,a,i,c,s,d=o(e);try{for(d.s();!(r=d.n()).done;){"childList"===r.value.type&&(n=void 0,a=void 0,i=void 0,c=void 0,s=void 0,n=l.querySelectorAll(".product-option"),a=l.querySelector(".cart-notification-product__image img"),i="Black"===document.querySelector('.product [name="Color"]:checked').value,c=u.get("tShirtResult"),s=u.get("tShirtBlackResult"),n.forEach((function(e){var t=e.querySelector("dt").textContent;u.get(t.replace(":",""))&&e.classList.add("hidden")})),a.setAttribute("src",i&&s||c))}}catch(e){d.e(e)}finally{d.f()}})).observe(l,{attributes:!0,childList:!0,subtree:!0})}document.querySelectorAll("[data-url]").forEach((function(e){var t=new URL(document.location),r=t.searchParams.get("key");e.setAttribute("data-url","".concat(t.pathname,"?key=").concat(r))})),document.querySelectorAll('.product [name="Color"]').forEach((function(e){e.addEventListener("change",(function(){console.log(e.value),m()}))}))}if(a){if(d){new MutationObserver((function(e,t){var r,n=o(e);try{for(n.s();!(r=n.n()).done;){"childList"===r.value.type&&g()}}catch(e){n.e(e)}finally{n.f()}})).observe(d,{attributes:!0,childList:!0,subtree:!0})}g()}}()}()}();